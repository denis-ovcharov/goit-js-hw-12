{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport { PAGE_SIZE } from '../main.js';\n\n\n\nexport async function getImagesByQuery(query, currentPage) {\n    const response = await axios.get('https://pixabay.com/api/', {\n        params: {\n            key: '50466269-2b1f45a47ffe964456016cff3',\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            page: currentPage,\n            per_page: PAGE_SIZE\n        }\n  \n\n    });\n    return response.data;\n}","import { refs } from \"../main\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\n//!===============================================================================\n\nlet lightbox;\n\nexport function createGallery(images) {\n    const markup = images.map((image) => \n        `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n        </a>\n        <ul class=\"image-info\">\n          <li class=\"info\">Likes<p>${image.likes}</p></li>\n          <li class=\"info\">Views<p>${image.views}</p></li>\n          <li class=\"info\">Comments<p>${image.comments}</p></li>\n          <li class=\"info\">Downloads<p>${image.downloads}</p></li>\n        </ul>\n      </li>`\n    ).join('');\n\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  } else {\n    lightbox.refresh();\n  }\n}\n//!===============================================================================\n\nexport function clearGallery() {\n  if (lightbox) {\n    lightbox.destroy();\n    lightbox = null;\n  }\n  refs.gallery.innerHTML = '';\n}\n//!===============================================================================\nexport function showLoader() {\n  refs.loader.classList.remove('hidden');\n}\n//!===============================================================================\nexport function hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n//!===============================================================================\nexport function showLoadMoreButton() {\n  refs.loadMoreBtn.classList.remove('hidden');\n}\n//!===============================================================================\nexport function hideLoadMoreButton() {\n  refs.loadMoreBtn.classList.add('hidden');\n}\n//!===============================================================================\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {\n    createGallery,\n    clearGallery,\n    showLoader,\n    hideLoader,\n    hideLoadMoreButton,\n    showLoadMoreButton\n} from './js/render-functions.js';\n//!===============================================================================\nexport const refs = {\n    form: document.querySelector('.form'),\n    gallery: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.load-more-btn'),\n    get galleryItem() {\n        return document.querySelector('.gallery-item')\n    }\n}\n //!===============================================================================\nlet query;\nexport let currentPage;\nexport let totalPages;\nexport const PAGE_SIZE = 15;\n//!===============================================================================\nrefs.form.addEventListener('submit', async e => {\n    e.preventDefault();\n\n    const submitBtn = e.target.querySelector('button[type=\"submit\"]');\n    submitBtn.disabled = true;\n\n    query = refs.form.elements.search.value.trim();\n    currentPage = 1;\n    if (!query) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Please, enter your search query to get photos.\",\n            position: 'topRight',\n        });\n        submitBtn.disabled = false;\n        return;\n    }\n    clearGallery();\n    hideLoadMoreButton();\n    showLoader();\n    \n    await loadImages(query, currentPage);\n\n    submitBtn.disabled = false;\n\n    e.target.reset();\n});\n\n//!===============================================================================\n    async function loadImages(query,currentPage) {\n        try {\n            const res = await getImagesByQuery(query, currentPage);\n\n            if (res.hits.length === 0) {\n                hideLoadMoreButton();\n                iziToast.error({\n                    title: \"Error\",\n                    message: \"Sorry, there are no images matching your search query. <br>Please try again!\",\n                    position: 'topRight',\n                });\n                \n                return;\n            }\n            createGallery(res.hits);\n\n            totalPages = Math.ceil(res.totalHits / PAGE_SIZE);\n            if (currentPage < totalPages) {\n                showLoadMoreButton();\n            } else {\n                hideLoadMoreButton();\n                iziToast.info({\n                    title: \"Info\",\n                    message: \"We're sorry, but you've reached the end of the results.\",\n                    position: 'topRight',\n                });\n            }\n        } catch (err) {\n            iziToast.error({\n                title: \"Error\",\n                message: \"Something went wrong. Please try again.\",\n                position: 'topRight',\n            });\n            console.error('API error:', err);\n        } finally {\n            hideLoader();\n        }\n}\n//!===============================================================================\n\nrefs.loadMoreBtn.addEventListener('click', async () => {\n    hideLoadMoreButton();\n    currentPage += 1;\n\n    await loadImages(query, currentPage);\n    \n    const galleryItemHeight = refs.galleryItem.getBoundingClientRect().height;\n    \n    window.scrollBy({\n        top: galleryItemHeight * 2,\n        left: 0,\n        behavior: \"smooth\",\n    });\n});\n//!===============================================================================\n\n\n\n"],"names":["getImagesByQuery","query","currentPage","axios","PAGE_SIZE","lightbox","createGallery","images","markup","image","refs","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","totalPages","e","submitBtn","iziToast","loadImages","res","err","galleryItemHeight"],"mappings":"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"}